Markov Network Toolbox (MoNeT) for Functional Connectivity Estimation
and Multi-Subject Inference
Steffie Tomson1, Manjari Narayan2, Susan Bookheimer1, and Genevera I. Allen2,3,4
1

Dept. of Psychiatry and Behavioral Sciences, University of California-Los Angeles
2
Dept. of Electrical and Computer Engineering & 3 Dept. of Statistics, Rice University, Houston, TX
4
Jan and Dan Duncan Neurological Research Institute; Houston, TX

Results Using Novel Statistical Framework to Account for all Sources of Uncertainty in Multi-Subject
Network Estimates

Markov Networks for Functional Connectivity

Functional MRI activation studies compare activation patterns across groups by accounting for
all sources of variability including intra-subject and inter-subject variability using random
effects test statistics. Recent interest in studying the networks of brain activation has led to a
plethora of studies comparing edges, nodes, and community network structures across
groups. Unfortunately current approaches to testing network features ignore the fact that
network estimates are not fixed, but highly variable due to both intra-subject and inter-subject
variability, as well as graph selection variability in high dimensions.

R3 - Resampling & Random Penalization & Random Effects [7, 8].
Resampling: Repeatedly bootstrap the fMRI time series for each subject and aggregate the results across bootstraps to estimate intra-subject variability of the network.
Random Penalization: In high dimensions and for select network features such as edges, randomize sparse penalty parameter for each resample to reduce graph selection bias and variability
Random Effects: Instead of standard tests, compute a random effects test statistic for every network feature such that it incorporates both intra-subject variance and inter-subject variance

We provide new statistical techniques to compare
features of multi-subject networks based on
resampling and random effects methods (R3).
I Markov Network Toolbox (MoNeT) for functional
connectivity estimation currently implements high
dimensional statistical methods to provide
functional connectivity models for multi-subject
fMRI data. R3 approaches will soon be supported
in MoNeT.
I We demonstrate the efficacy of our novel
methods on the Autism Brain Imaging Data
Exchange (ABIDE) dataset and on
colored-sequence synesthesia.
I

Markov Networks produce reliable and biologically interpretable edges in network
models.[2, 3]
I In high dimensions, when the number of brain regions is large, if true graph structure is
sparse (i.e. assuming not all brain regions have direct functional connections), we can
estimate the network despite limited number of fMRI time points.
I

I

I

Differential Testing for Mutually Exclusive Edges (Simulation Example)

Differential Testing of Modularity Patterns

We simulated fMRI data for two distinct populations such that the true underlying network
was small world.
3
I Figs (g),(h) reveal that R more effectively eliminates spurious differences.
I

1.2

3

R

Θ- Partial Covariance, Σ- Covariance
High dimensional graphs Θ can be estimated by eliminating edges attributed to noise. A popular method is to achieve this is to
penalize the maximum likelihood as in the graphical lasso algorithm [4].
The penalty or regularization parameter λ determines the number of edges and is found using model selection methods such as
Stability Selection [5] or StARS [6].



Θ̂(λ) = arg min − log (det Θ) + Tr Σ̂Θ + λkΘk1



Θ0

Standard

TP=FP Line

1.1
1
0.9
0.8

100

0.7
0.6
0.5
0.4

50

0.3
0.2

A Community or module refers to groups of nodes that are more connected to each other
than to nodes from other modules.
I Co-occurance frequency measures how frequently two nodes belong to the same
module after repeatedly perturbing the data
I Modularity assignments can be highly variable to due within subject variability. Therefore,
use resampling to reduce uncertainty in modularity assignments in every subject.
I Resampling + random effects node level test-statistic [9] detects nodes that reveal
statistically significant differences in modularity allegiance.
I

(A) represents a toy network
obtained after 1 resampling of the
data, along with re-estimation and
re-clustering of the network for a
single synesthetic subject.

0.1

(Graphical Lasso)

0
0

50

100

0
150

# of False Positives

Objectives: Two Group Comparisons of Graph Topological Features

Motivation: The standard hypothesis testing framework is inadequate.
The goal is to find differences in edge structure between two groups.
A Simple Two-Sample Test Fails to Account for all Sources of Uncertainty in
Multi-Subject Data
I

I

Does a node have denser
connections in the control group ?

Community Level Example

Graphical Model Estimation and Model Selection.

Objective & Motivation

Does a specific edge or functional
connection have a stronger
presence in a diseased group ?

Edge Level Example

# of True Positives

Edges in Markov Networks indicate direct relationships between two regions of interest.
Indirect edges that might have occurred in simple correlation networks are eliminated.

% of True Positives

Introduction

Does a node show differential
community allegiances between
diseased and control groups ?

Variability in Multi-Subject Networks Pose a Challenge to Inference
Subject networks are estimated from noisy neuroimaging data.
I Each subject network in neuroimaging is not fixed, but a highly variable estimated
quantity.
I In addition to inter-subject variability, each subject network possesses intra-subject variability
as well.
I Any hypothesis test to obtain p-values on network features should account for all sources of
uncertainty, otherwise the p-value for each network feature will be incorrect and misleading.
I

I

We simulated data assuming known network structure for two groups of subjects, 20
subjects per group. We then perform the following standard approach to network
comparisons.
I Estimate Markov networks from simulated data per subject,
I Test for mutually exclusive differential edges using a simple two-sample z test.
I Apply multiple testing procedures to find differential edges.
Results: Given the true differential edges (red) between the groups, most of the detected
differences were spurious and were actually common to both groups!

(f) True Positive Counts (Y-Axis), False Positive

(g) Estimated Differences (Upper), Standard

(h) Estimated Differences (Upper), R3

Counts(X-Axis)

Inference

Inference

(B) illustrates the co-occurance
when the seed node of interest
(NOI) X2 co-occurs with node X4 in
the orange module.

The R3 approach is almost 4 times better than standard hypothesis testing in terms of
identifying true differences with false discovery control. Each subject has 50 nodes, 400
observations, with 20 subjects per group. Similar results hold for 100 node networks.

Differential Testing for Mutually Exclusive Edges (R3) in ABIDE Suggest
Common Patterns in ASD Literature
I
I

Fewer long-range connections in ASD
Fewer bilateral connections in ASD

IFG edges not present in ASD
I Fusiform edge not present in ASD
I

List of edges differentially present in ASD

List of edges differentially present in Controls

ROI
ROI
Raw P-value
1. Left frontal pole Left insula (18)
.0016
(16)
2. Left caudate (2)
Left
subcallosal
.0102
cortex (68)

ROI
3. Right IFG, po.(27)

Problem: A regular two-sample test only accounts for inter-subject variability. Does not
account for intra-subject network variability or graph selection variability in Markov
Networks.

We use the standard approach to find such differential edges between two groups of
simulated data, below.

(C) & (D) aggregate co-occurance
frequencies from 100 resamples for
subjects in both groups.

ROI
Raw P-value
Right po. supra.0012
marginal(55)
4. Left sup. parietal Right sup. parietal
.0028
(50)
(51)
5. Right IFG, pt(25)
Right
poste.0067
rior supramarginal
(55)
6. Right post. central Left superior pari.0076
(49)
etal (50)
7. Left lateral occipital Superior
right
.0098
cortex(58)
fusiform (95)

A summary of the modularity analysis procedure using an example toy network.
(Reproduced from Tomson, et al. 2013)

Differential Nodes based on
Community Patterns in
Colored-sequence Synesthesia
I

I

I

Markov Network Toolbox (MoNeT)
www.bitbucket.org/gastats/monet
R3 Coming Soon to MoNeT

Colored Sequence Synesthesia is a perceptual condition in
which people automatically experience color upon hearing or
seeing graphemes (numbers and letters).
In the experiment 20 synesthetes and 19 controls listened to
audio clips of graphemes from Sesame Street.
Green nodes demonstrate differential modularity patterns
between groups

Synesthetes utilize more visual regions
than controls, while controls unite frontal
and parietal regions significantly more
often than synesthetes.(Tomson, et al.
2013).

Bibliography
[1] (2013, May) Abide: Autism brain imaging data exchange.
[2] S. M. Smith, K. L. Miller, G. Salimi-Khorshidi, M. Webster, C. F. Beckmann, T. E. Nichols,
J. D. Ramsey, and M. W. Woolrich, “Network modelling methods for fmri,” NeuroImage,
vol. 54, no. 2, pp. 875–891, 1 2011.
[3] S. M. Smith, “The future of fmri connectivity,” NeuroImage, no. 0, pp. –, 2012.
[4] J. Friedman, T. Hastie, and R. J. Tibshirani, “Sparse inverse covariance estimation with
the graphical lasso,” Biostatistics, vol. 9, no. 3, pp. 432–441, July 2008.
[5] N. Meinshausen and P. Buhlmann, “Stability selection,” J. Roy. Statist. Soc. Ser. B,
vol. 72, no. 4, pp. 417–473, 2010.

(d) Small World Graph

(a) Autism Subject 1

(b) Autism Subject 2

(c) Autism Subject 3

Markov Network subject variability in ABIDE [1].

[6] H. Liu, K. Roeder, and L. Wasserman, “Stability approach to regularization selection
(stars) for high dimensional graphical models,” in Advances in Neural Information
Processing Systems, 2010.

(e) Small World Graph, 83% FDP

Results of simple two-sample tests to identify differential edges.
I Fig (d) shows that spurious edge differences overwhelm true edge differences very
quickly.
I Fig (e) shows that 83% of the estimated differential structure (Upper) is a false difference
compared to the true graph structure (Lower) .

Circular graphs of ASD and control groups with 113 regions of interest (blue nodes)
from the Harvard-Oxford Atlas and 235 edges tested. Individual subject graphs were
estimated for 41 autistic subjects and 32 control subjects using our randomized inference
procedure. Preliminary analysis of resting state data from the ABIDE dataset revealed 7
differential edges with an estimated direct FDR of 26%.

Acknowledgements: The authors would like to acknowledge support from the Neurobehavioral Genetics Training Grant under NIH T32 MH073526-05 and the National Science Foundation under NSF DMS-1209017.
Contact authors at steffietomson AT gmail DOT com and manjari.narayan, gallen AT rice DOT edu.

[7] M. Narayan and G. I. Allen, “Randomized approach to differential inference in
multi-subject functional connectivity,” in Proceedings of the 3rd International Workshop
on Pattern Recognition in Neuroimaging, 2013.
[8] M. Narayan, G. I. Allen, and S. Tomson, “Two sample inference for populations of
graphical models with applications to functional brain connectivity,” (Working Paper),
2013.
[9] S. Tomson, M. Narayan, G. I. Allen, and D. Eagleman, “Neural networks of colored
sequence synestheisa,” Journal of Neuroscience, 2013.

