Title:
Dynamic fluctuations in integration and segregation within the human
functional connectome

Authors:
James M. Shine1,2, Peter T. Bell3, Oluwasanmi Koyejo1, Krzysztof J. Gorgolewski1,
Craig A. Moodie1, and Russell A. Poldrack1

Affiliations:
1 – Department of Psychology, Stanford University, Stanford, CA, USA
2 – Neuroscience Research Australia, The University of New South Wales,
Sydney, NSW, Australia
3 – Queensland Brain Institute, The University of Queensland, Brisbane, QLD,
Australia

Corresponding author:
James M. Shine – macshine@stanford.edu

Abstract:
Higher brain function relies upon the ability to flexibly integrate information
across specialized communities of macroscopic brain regions, but it is unclear
how this mechanism manifests over time. Here we characterized patterns of
time‑resolved functional connectivity using resting state and task fMRI data from
a large cohort of unrelated subjects. Our results demonstrate that dynamic
fluctuations in network structure during the resting state transition between
states of integrated and segregated network topology. These patterns were
altered during task performance, demonstrating a higher level of network
integration that tracked with task complexity. Replication analyses demonstrated
that the results were reproducible across sessions, sample populations and
datasets. Together these results provide evidence for metastability in the brain’s
coordination between integration and segregation.

Main Text:
A fundamental aspect of higher brain function is the ability to flexibly integrate
communication between a range of specialized sub‑networks (1, 2). To achieve
this dynamic equilibrium, it has been hypothesized that the human brain strikes
a metastable balance between the local segregation of function and the global
integration of information (3‑7). An emerging picture from this recent work
suggests that a relatively fixed structural scaffold gives rise to a highly dynamic
functional landscape (1, 8, 9), in which the emergence of momentary neural
coalitions forms the basis for complex cognitive functions (10), learning (11) and
consciousness (12). However, there is currently little direct evidence regarding
how this metastable balance is achieved and the manner in which it evolves over
time.

Here we capitalize on recent advancements in high‑speed fMRI acquisition by
analyzing sub‑second resolution resting state and task data using a recently‑
described metric for time‑resolved connectivity analysis (13). Our examination of
the evolution of network structure over the course of seconds to minutes
demonstrates that the human brain traverses a network state space that
fluctuates between topological configurations that emphasize either segregation
or integration.

We first calculated patterns of time‑resolved functional connectivity in a cohort
of 92 unrelated subjects obtained from the Human Connectome Project (HCP)
(14). We then performed graph theoretical analyses on these data that identified
the topological properties of each brain region within each temporal window
(15). In order to test whether the results were reflective of statistically significant
non‑stationary fluctuations in brain connectivity, in accordance with recent work

(16, 17), our results were tested against a stationary null model. Furthermore, all
results were replicated in: i) an independent resting state session in these same 92
individuals; ii) a second set of 92 unrelated individuals from the HCP sample,
and; iii) a set of 152 individuals obtained from the Nathan Kline Institute (NKI),
Rockland sample (18). The results also survived a range of preprocessing
approaches, and we exhaustively tested and rejected any relation of the results to
head motion, which is a concern in resting state fMRI (19) (see Supplementary
Materials).

To characterize time‑resolved network topology, we computed region × region
time‑resolved functional connectivity matrices using the Multiplication of
Temporal Derivatives (MTD) (13) within a sliding temporal window of 10
seconds (see Supplementary Materials) (Figure S1). We then performed community
detection within each window, which enabled classification of each region
according to its profile of within‑ (WT) and between‑module (BT) connectivity
(Figure S2 and Supplementary Materials). Consistent with previous work, we
subsequently classified the information processing role of each region within
each temporal window based on its’ cartographic class (15, 20, 21) (See Figure 1b
for details of classification). For instance, a region with high WT and BT was
classified as a ‘connector hub’ and by inference, was considered to promote
global integration (Figure 1b), whereas a region with high WT but low BT was
classified a ‘provincial hub’ and was considered to promote within‑module
integration. We found that a different class of regions, peripheral nodes, which
have relatively weak connectivity both within and between modules, dominated
the cartographic landscape (Figure 1d), suggesting that the majority of regions
were topologically isolated over time, with a minority of connector hub regions
providing a functional bridge between otherwise isolated neural communities

(see Figure 1c). Importantly, the pattern of cartographic classes within the resting
brain was significantly different from the pattern observed in the stationary null
model based on the mean covariance structure of the data (F1,91 = 310, p < 0.001),
rejecting the null hypothesis of stationary network cartography (Figure 1d) and
suggesting that the functional connectome explores a dynamical repertoire that
plays out over seconds to minutes in the resting brain.

Figure 1: Dynamic Cartographic Analysis. a) Regions were classified according to within‑ (WT)
and between‑module (BT) connectivity: hub regions (WT ≥ 2.5) were parcellated into provincial
(BT < 0.3), connector (0.3 ≤ BT < 0.8) or kinless hubs (BT ≥ 0.8); nodes (WT < 2.5) were parcellated
into ultra‑peripheral (BT < 0.05), peripheral (0.05 ≤ BT < 0.6), connector (0.6 ≤ BT < 0.85) and kinless
nodes (BT ≥ 0.85), in line with (15); b) schematic diagram of each cartographic class – kinless
nodes and kinless hubs are not shown, as they were not found in any temporal window for any
subject in our analysis; c) group mean joint histogram of WT and BT during rest – intensity in each
100 × 100 cell reflects the log10 frequency that each cell was occupied during the resting state
session; d) mean percentage of each time‑series associated with each cartographic class for resting
state data (dark) and VAR null data (light) – resting data was associated with a higher proportion

of ultra‑peripheral (WT < 2.5 & BT < 0.05) and peripheral nodes (WT < 2.5 & BT < 0.30) than the
VAR null data (mixture of peripheral and connector nodes) – error bars reflect standard deviation
of region frequency over 92 unrelated subjects; e) mean percentage of each time‑series associated
with each hub class. Abbreviations: uPN – ultra‑peripheral nodes; PN – peripheral nodes
(orange); CN – connector nodes (green); PH – peripheral hubs (dark blue) and CH – connector
hubs (red); KN – kinless nodes (sky blue); KH – kinless hubs (tan); VAR – vector autoregressive
null model.

We also observed distinct and reproducible patterns of network hub topology in
the time‑resolved resting brain. The relative percentage of time that each region
behaved as each cartographic class demonstrated significant heterogeneity (see
Figure 2 and S3). For example, frontoparietal, striatal and hippocampal regions
spending the greatest duration of time as connector hubs (Figure 2a), implicating
these regions as important for facilitating whole‑brain integration. In contrast,
regions classically associated with the default and cinguloparietal systems were
the most likely to act as provincial hubs over time, thus promoting
communication within their own module (Figure 2b & c).

Figure 2: Dynamic Hub Structure in the Resting Brain. a) The regional pattern associated with
regions that spent the highest proportion of the resting state session acting as a connector hub
(red/yellow), with respect to all other regions; b) regional pattern associated with preferential
increase in time acting as a provincial hub (red/yellow), with respect to all other regions; c) Z‑
scored mean percentage of time acting as either a connector or provincial hub, collapsed into each
of 15 pre‑defined large‑scale cortical networks (31); d) the regional pattern associated with
regions that spent the most time within the same module as a connector hub (red/yellow), with
respect to all other regions; e) the regional pattern associated with preferential increase in time
occurring within the same module as a provincial hub (red/yellow), with respect to all other
regions; f) Z‑scored mean percentage of time within the same module as a connector or provincial
hub, collapsed into each of 15 pre‑defined brain systems defined in a previous time‑averaged
study (35). Images available at http://neurovault.org/collections/HAWDIOCD/. Key: Aud –
Auditory; CON – Cingulo‑Opercular; Cpar – Cingulo‑parietal; DMN – Default Mode; DAN –
Dorsal Attention; FPN – Frontoparietal; FTP – Fronto‑temporal; RSp – Retrosplenial; SN –

Salience; SMH – Somatomotor Hand; SMM – Somatomotor Mouth; VAN – Ventral Attention; VIS
– Visual; SC – Subcortical; CBM – Cerebellum.

Although the most integrated regions within a complex network are crucial for
defining the information processing capacity of the system, their functional
importance is defined by which nodes they inter‑connect (6). By identifying the
regions that were within the same module as a connector hub (and hence, were
integrated within that window), we found that the connector hubs preferentially
integrated

primary

processing

regions,

such

as

visual,

auditory

and

somatomotor cortex. In contrast, provincial hubs primarily connected with
regions within the cerebellum and cinguloparietal network (Figure 2f). These
results suggest that the integrative core of the brain over time was composed of
dynamic and flexible hubs that recruited the involvement of neuronal assemblies
composed of relatively segregated nodes.

An analysis of temporal fluctuations in cartography identified the presence of
two topological ‘states’ that alternated over time, one of which was characterized
by the predominance of ultra‑peripheral nodes and provincial hubs (reflecting
relatively segregated network function; segregation Z‑score [ZS] ≥ 1.65: 14.90 ±
1.8% of time series across subjects), and another that was characterized by the
predominance of connector hubs, connector nodes and peripheral nodes
(reflecting relatively integrated network function; integration Z‑score [ZI] ≥ 1.65:
29.26 ± 3.7% of time series) (Figure 3a). The majority of the resting session was
associated with a mixture of these two states (both ZI and ZS < 1.65: 55.79 ± 5.1%
of time series), providing evidence for metastable dynamics in the resting brain
(7). The more integrated state was characterized by connectivity between
default/frontoparietal systems and primary processing networks, such as the

auditory, somatosensory and visual networks (Figure S4; FDR p < 0.05). In
contrast, the segregated state demonstrated stronger internal connectivity within
the default and frontoparietal systems, which became functionally detached from
the primary processing systems (Figure S4; FDR p < 0.05). These results suggest
that the brain had to disengage the connections between higher‑level control
systems and primary processing systems to enter into the more segregated state.
The two states also showed a tradeoff in their topology, such that temporal
windows associated with the segregated state had significantly greater
modularity (QS = 0.55 ± 0.1 vs. QI = 0.42 ± 0.2; p < 0.001) whereas those associated
with the integrated state had greater global efficiency (ES = 0.18 ± 0.03 vs. EI = 0.24
± 0.05; p < 0.001; Figure 3d). This topological double dissociation suggests that
the dynamic fluctuations in network structure constrain global information
processing. Furthermore, these patterns were absent in the VAR null dataset
(Figure S6).

Figure 3: Dynamic Cooperation and Competition between Cartographic Classes: a) Temporal
fluctuations in network topology identified the presence of two temporal topological ‘states’: one
composed of ultra‑peripheral nodes and peripheral hubs (‘Segregated’); and the other composed
of peripheral nodes, connector nodes and connector hubs (‘Integrated’); b) a characteristic time
series (subject ID: HCP 100307) of the relative proportion of regions associated with each
cartographic class (colored lines above); c) cartographic time series were then parcellated
according to each state (Segregated [red] – prevalence of uPN and PH; Integrated [blue] –
prevalence of PN, CN and CH); d) temporal windows associated with the segregated state were
associated with significantly greater modularity and reduced global efficiency than those
associated with the integrated state; e) a k‑means (k = 2) clustering analysis using on the time‑
resolved joint histogram confirmed the presence of these two states in the cartographic profile
analysis. Key: uPN – ultra‑peripheral nodes; PN – peripheral nodes; CN – connector nodes; PH –
peripheral hubs; CH – connector hubs; *** ‑ significant at p < 0.001.

In order to assess the temporal classification into two states without requiring the
labeling of each node into cartographic classes (15), for each window we
computed a joint histogram of within‑ and between‑module connectivity
measures, which we refer to here as a “cartographic profile”. K‑means clustering
of these full profiles (k = 2, although the results were stable for k > 2; see
Supplementary Methods) confirmed the identification of relatively integrated and
segregated states described above (ZS and ZI > 0; Dice’s coefficient between
analyses = 0.792 ± 0.04; Figure 3e), providing further evidence that the brain
fluctuates between states with distinct topologies, and by inference, different
modes of information processing (see Figure 3e). Examination of individual
subject data confirmed that the resting brain explored a dynamical repertoire
within the topological space, fluctuating between the integrated and segregated
temporal states identified in the clustering analysis above (see Figure S10 & S11).

A direct prediction of our findings from the time‑resolved resting analysis is that
the balance between network integration and segregation of the brain should
track ongoing cognitive function over time. We tested this hypothesis using data
from two tasks from the HCP (22) in the discovery cohort of 92 subjects: a simple
motor task and a visual N‑back task. We observed a distinct alteration in the
cartographic profile during the performance of both tasks when compared to the
resting state (Figures 4a & b), with a significant increase in connecitvity between
modules (Figure 4b), suggesting that the brain had entered into a state of higher
integration in order to meet the demands of the task (Motor: F1,91 = 392.1, p <
0.001; N‑back: F1,91 = 420.3, p < 0.001; Figures 4c). Importantly, the extent of
reconfiguration during task performance varied as a function of the cognitive
demands of the task, with the N‑back task showing a greater shift towards a
more integrated network topology (Figure 4d). We quantified this effect by

estimating the affine transformation required to align each subjects’ resting
cartographic profile with their profile during task. This analysis demonstrated
that the N‑back task caused a shift towards a more integrated network topology
relative to the Motor task (transformation along the BT axis – N‑back: +0.21;
Motor: +0.18; t91 = 5.18, p < 0.001; Figure 4d).

Figure 4: Alteration of cartographic profile during task performance: a) group mean joint
histogram of WT and BT for task blocks during the N‑back task – intensity in each 100 × 100 cell
reflects the log10 frequency that each cell was occupied during the resting state session; b) regions
of the 2‑dimensional joint histogram space that were significantly different between N‑back task
blocks and the resting state (paired‑samples t‑test) – colored points indicate a region that
survived false discovery correction (q < 0.01): yellow/red – increased frequency during N‑back
task blocks; blue/light blue – increased frequency during resting state; c) mean percentage of each
time‑series associated with each cartographic class for resting state data (grey), motor task (blue)
and N‑back task blocks (red) – resting data was associated with a higher proportion of ultra‑
peripheral (WT < 2.5 & BT < 0.05) and peripheral nodes (WT < 2.5 & BT < 0.30) than both sets of task
data, which shifted to a more integrated state as a function of task complexity – error bars reflect
standard deviation of region frequency over 92 unrelated subjects; d) histogram reflecting the

affine transformation required to match each participants’ resting state cartographic profile to
match the cartographic profile during the each task along the between‑module (BT) connectivity
axis (Motor – blue; N‑back – red). Abbreviations: uPN – ultra‑peripheral nodes; PN – peripheral
nodes (dark blue); CN – connector nodes (green); PH – peripheral hubs (orange) and CH –
connector hubs (red).

Notably, participants spent less time in the segregated state during performance
of the two tasks than during rest (ZS > 1.65 – Motor: 6.57 ± 1.9%; N‑back: 6.30 ±
1.5%); however, we found that the cartographic profile preferentially shifted
towards the more segregated state during the interleaved ‘rest’ blocks during
both tasks (Motor: 68.42 ± 2.3% of rest TRs were associated with ZS > 1.65; N‑
back: 61.63 ± 1.4%; see Figure S12). In addition, both tasks showed an increase in
global efficiency (�!"#.! : 0.354 ± 0.03; �!"#$%.! : 0.340 ± 0.04) and a decrease in
modularity (�!"#.! : ‑0.312 ± 0.02; �!"#$%.! : ‑0.333 ± 0.05) as a function of task,
further implicating the need to flexibly trade‑off global topological properties in
order to complete the behavioral tasks (23). Together, these results suggest that
the performance of a demanding cognitive task caused a targeted reorganization
of the integrative core of the brain into a unique network assembly that was
integral for the performance of each task (24).

To test the reliability of our results, we performed three separate replication
analyses: i) on a second resting state session (with identical imaging parameters)
from the same cohort of 92 unrelated subjects; ii) on a different cohort of 92
unrelated subjects (with identical imaging parameters) from the HCP
consortium; and iii) on 152 subjects from a separate dataset acquired at a
different scanning site, acquired using high‑resolution functional data from the
NKI Rockland dataset (18). In each case, we replicated the analyses described

above on each subject and then summarized each outcome measure of interest at
the group level. We then compared the results obtained from the replication with
the results obtained from the original sample using a parcel‑wise Pearson’s
correlation coefficient. For each analysis, we observed strong positive
correlations between the summary measures derived from each analysis
(minimum r = 0.564; all p < 0.0001; see Supplementary Materials), suggesting that
the time‑resolved measures identified in this study were reliable across sessions,
individuals and even across datasets collected using different scanners and
imaging protocols.

In this study, we mapped the spatiotemporal dynamics of network structure in
the human brain, revealing a dynamical system that fluctuates between
segregated and integrated network topology. Our results thus provide evidence
for metastable dynamics in the human brain (Figure 3). In the resting state,
coordinated fluctuations in network structure supported the emergence of
transient neural coalitions that were integrated by a network of regions
comprising frontal, parietal and temporal cortex, as well as striatum (Figure 2). In
contrast, the cartographic profile of the brain was modulated by the performance
of both a simple motor and more cognitively‑demanding task, both of which
caused a targeted reorganization of network architecture into a highly integrated
neuronal assembly that varied as a function of task complexity (Figure 4).

Our results demonstrate that the functional neural landscape spontaneously
transitions between coordinated assemblies of node classes that comprise one
state of high modularity and low global efficiency and another contrasting
topological state of reduced modularity and higher global efficiency (Figure 3).
Interestingly, the most preferentially segregated regions in the brain (i.e. regions

in sensory and motor cortices) were the most likely to be ‘recruited’ by the most
integrated regions (i.e. frontal, parietal and temporal cortex, as well as striatum)
(Figure 2f). Together with the fluctuations observed at the whole brain level,
these findings suggest that the resting brain consists of a dynamically evolving
neural architecture, in which a strongly integrated core inter‑connects a range of
other regions, with the majority of the brain remaining relatively isolated from
the core. As such, our results suggest that the patterns observed in time‑averaged
analyses of the resting brain may be composed of a combination of different
signals – those demonstrating baseline levels of communication between
relatively segregated regions that closely mirror the structural connectome (9)
and those reflective of the functional activity superimposed onto the idling
architecture of the brain, such as the patterns tracking the internal cognitive state
over time (25). This hypothesis is supported directly by our finding that the
global information processing state of the brain was altered during the
performance of both a simple motor task, as well as an N‑back task that recruits
working memory maintenance and updating (Figure 4). It follows that specific
departures from the resting spatiotemporal architecture should be observed
during the performance of other behavioral tasks, when unique networks of
regions should coordinate their activity to promote integration, as well as during
slow wave sleep and in the minimally conscious state (26), when the pattern
should shift towards a more segregated architecture.

Although the functional implication of the results of our analyses require further
confirmation, particularly without an effective means for tracking the contents of
conscious thoughts over time, one potential hypothesis is that the areas
identified as important for integration in our study reflect the activity of the so‑
called ‘dynamic core’ (27, 28). There is already strong empirical support for these

concepts in the neuroscience literature (6), predominantly from global workspace
theories of consciousness in which the widespread ‘distribution’ of information is
proposed to mediate conscious experience (2). Indeed, given the known
importance of whole‑brain integration for the execution of complex behavior
(29), the regions integrated by the connector hubs within each window represent
an attractive candidate for dynamically tracking the activity within the global
workspace. In future studies, the definition of the manner in which distributed
neural regions interact with one another across multiple time‑scales (30) will help
to shift our modern theories of brain function closer to a biological explanation of
the neuronal mechanisms that support conscious experience.

Acknowledgements:
The data reported in this paper were made publicly available by the Human
Connectome Project and 1000 Functional Connectomes project. There were no
conflicts of interest for any authors. JMS, OK, PTB and RAP designed the
analysis. JMS performed the analysis and wrote the first draft. JMS, OK, CAM,
PTB, KJG and RAP reviewed and edited the manuscript. We would like to thank
Vanessa Sochat for her assistance with the implementation of the analysis,
Michael Riis and Ian Eisenberg for their helpful insights and Tim Laumann,
Claire O’Callaghan, Patrick Bissett and Rav Suri for their critical review of the
manuscript.

References:
1.

S. E. Petersen, O. Sporns, Brain Networks and Cognitive Architectures.
Neuron. 88, 207–219 (2015).

2.

S. Dehaene, J. P. Changeux, L. Naccache, Conscious, preconscious, and
subliminal processing: a testable taxonomy. Trends in Cognitive Sciences. 10,
204–211 (2006).

3.

G. Tononi, O. Sporns, A measure for brain complexity: relating functional
segregation and integration in the nervous system. Proceedings of the
National Academy of Sciences. 91, 5033–5037 (1994).

4.

M. P. van den Heuvel, O. Sporns, Network hubs in the human brain.
Trends in Cognitive Sciences. 17, 683–696 (2013).

5.

O. Sporns, Network attributes for segregation and integration in the
human brain. Current Opinion in Neurobiology. 23, 162–171 (2013).

6.

F. Varela, J. P. Lachaux, E. Rodriguez, The brainweb: phase
synchronization and large‑scale integration. Nature Reviews Neuroscience. 2,
229–239 (2001).

7.

J. Kelso, Multistability and metastability: understanding dynamic
coordination in the brain. Transactions of the Royal Society B. 367, 906–918
(2012).

8.

G. Deco, G. Tononi, M. Boly, M. L. Kringelbach, Rethinking segregation
and integration: contributions of whole‑brain modelling. Nat. Rev. Neurosci.
16, 430–439 (2015).

9.

K. Shen, R. M. Hutchison, G. Bezgin, S. Everling, A. R. McIntosh, Network
structure shapes spontaneous functional connectivity dynamics. J. Neurosci.
35, 5579–5588 (2015).

10.

M. W. Cole, D. S. Bassett, J. D. Power, T. S. Braver, S. E. Petersen, Intrinsic
and task‑evoked network architectures of the human brain. Neuron. 83,
238–251 (2014).

11.

D. S. Bassett, M. Yang, N. F. Wymbs, S. T. Grafton, Learning‑induced
autonomy of sensorimotor systems. Nat Neurosci. 18, 744–751 (2015).

12.

P. Barttfeld et al., Signature of consciousness in the dynamics of resting

state brain activity. Proceedings of the National Academy of Sciences. 112, 887–
892 (2015).
13.

J. M. Shine et al., Estimation of dynamic functional connectivity using
Multiplication of Temporal Derivatives. NeuroImage. 122, 399–407 (2015).

14.

S. M. Smith et al., Resting state fMRI in the Human Connectome Project.
NeuroImage. 80, 144–168 (2013).

15.

R. Guimerà, L. A. Nunes Amaral, Functional cartography of complex
metabolic networks. Nature. 433, 895–900 (2005).

16.

A. Zalesky, A. Fornito, L. Cocchi, L. L. Gollo, M. Breakspear, Time‑resolved
resting state brain networks. Proceedings of the National Academy of Sciences.
111, 10341–10346 (2014).

17.

F. de Pasquale, S. Della Penna, O. Sporns, G. L. Romani, M. Corbetta, A
Dynamic Core Network and Global Efficiency in the Resting Human Brain.
Cereb. Cortex, bhv185 (2015).

18.

K. B. Nooner et al., The NKI‑Rockland Sample: A Model for Accelerating
the Pace of Discovery Science in Psychiatry. Front. Neurosci. 6, 152 (2012).

19.

J. D. Power, K. A. Barnes, A. Z. Snyder, B. L. Schlaggar, S. E. Petersen,
Spurious but systematic correlations in functional connectivity MRI
networks arise from subject motion. NeuroImage. 59, 2142–2154 (2012).

20.

O. Sporns, Cerebral cartography and connectomics. Philos. Trans. R. Soc.
Lond., B, Biol. Sci. 370, 20140173–20140173 (2015).

21.

O. Sporns, R. F. Betzel, Modular Brain Networks. Annu Rev Psychol. 67,
annurev–psych–122414–033634 (2015).

22.

D. M. Barch et al., Function in the human connectome: task‑fMRI and
individual differences in behavior. NeuroImage. 80, 169–189 (2013).

23.

B. Mišić, O. Sporns, A. R. McIntosh, Communication efficiency and
congestion of signal traffic in large‑scale brain networks. PLoS Comput. Biol.
10, e1003427 (2014).

24.

F. M. Krienen, B. T. T. Yeo, R. L. Buckner, Reconfigurable task‑dependent
functional coupling modes cluster around a core functional architecture.
Philos. Trans. R. Soc. Lond., B, Biol. Sci. 369, 20130526–20130526 (2014).

25.

M. G. Berman et al., Does resting state connectivity reflect depressive
rumination? A tale of two analyses. NeuroImage. 103, 267–279 (2014).

26.

A. Demertzi et al., Intrinsic functional connectivity differentiates minimally
conscious from unresponsive patients. Brain. 138, 2619–2631 (2015).

27.

G. Tononi, G. M. Edelman, Consciousness and complexity. Science. 282,
1846–1851 (1998).

28.

G. M. Edelman, Naturalizing consciousness: a theoretical framework.
Proceedings of the National Academy of Sciences. 100, 5520–5524 (2003).

29.

M. P. van den Heuvel, O. Sporns, An anatomical substrate for integration
among functional networks in human cortex. J. Neurosci. 33, 14489–14500
(2013).

30.

C. J. Honey et al., Slow cortical dynamics and the accumulation of
information over long timescales. Neuron. 76, 423–434 (2012).

31.

M. F. Glasser et al., The minimal preprocessing pipelines for the Human
Connectome Project. NeuroImage. 80, 105–124 (2013).

32.

B. B. Avants, C. L. Epstein, M. Grossman, J. C. Gee, Symmetric
diffeomorphic image registration with cross‑correlation: evaluating
automated labeling of elderly and neurodegenerative brain. Med Image
Anal. 12, 26–41 (2008).

33.

J. D. Power et al., Methods to detect, characterize, and remove motion
artifact in resting state fMRI. NeuroImage. 84, 320–341 (2014).

34.

Y. Behzadi, K. Restom, J. Liau, T. T. Liu, A component based noise
correction method (CompCor) for BOLD and perfusion based fMRI.
NeuroImage. 37, 90–101 (2007).

35.

E. M. Gordon et al., Generation and Evaluation of a Cortical Area
Parcellation from Resting state Correlations. Cereb. Cortex, bhu239 (2014).

36.

J. Diedrichsen, J. H. Balsters, J. Flavell, E. Cussans, N. Ramnani, A
probabilistic MR atlas of the human cerebellum. NeuroImage. 46, 39–46
(2009).

37.

M. E. Raichle, The restless brain. Brain Connectivity. 1, 3–12 (2011).

38.

T. E. Nichols, A. P. Holmes, Nonparametric permutation tests for
functional neuroimaging: a primer with examples. Hum Brain Mapp. 15, 1–
25 (2002).

39.

M. Rubinov, O. Sporns, Complex network measures of brain connectivity:
Uses and interpretations. NeuroImage. 52, 1059–1069 (2010).

40.

J. D. Power, B. L. Schlaggar, C. N. Lessov‑Schlaggar, S. E. Petersen,
Evidence for hubs in human functional brain networks. Neuron. 79, 798–
813 (2013).

41.

N. Leonardi, D. Van De Ville, On spurious and real fluctuations of
dynamic functional connectivity during rest. NeuroImage. 104, 430–436
(2015).

42.

A. Zalesky, M. Breakspear, Towards a statistical test for functional
connectivity dynamics. NeuroImage. 114, 466–470 (2015).

43.

M. Rosvall, C. T. Bergstrom, Maps of random walks on complex networks
reveal community structure. Proceedings of the National Academy of Sciences.
105, 1118–1123 (2008).

44.

P. J. Mucha, T. Richardson, K. Macon, M. A. Porter, J.‑P. Onnela,
Community structure in time‑dependent, multiscale, and multiplex
networks. Science. 328, 876–878 (2010).

Supplementary Materials
Data acquisition
For the primary discovery analysis, minimally preprocessed resting fMRI data
were acquired from 100 unrelated participants from the Human Connectome
Project (mean age 29.5 years, 55% female) (31). For each participant, 14 minutes
30 seconds of resting state data were acquired using multiband gradient‑echo
echoplanar imaging. The following parameters were used for data acquisition:
relaxation time (TR) = 720 ms, echo time = 33.1 ms, multiband factor = 8, flip
angle = 52 degrees, field of view = 208x180 mm (matrix = 104 x 90), 2x2x2
isotropic voxels with 72 slices, alternated LR/RL phase encoding.

In addition to the discovery analysis, we also performed an extensive series of
replication analyses including: i) data from the same participants using resting
state data acquired during a second rest scan during the same scanning session;
ii) an independent cohort of 100 unrelated participants from the HCP dataset
using identical acquisition parameters at the same scanning site; and iii) an out‑
of‑sample replication using data collected from the NKI Rockland sample (TR =
650msec; voxel‑size 3mm3) as part of the 1000 Functional Connectomes Project
(18).

Data pre‑processing
Bias field correction and motion correction (12 linear DOF using FSL’s FLIRT)
were applied to the HCP resting state data as part of the minimal preprocessing
pipeline (31). The first 100 time points were discarded from the data due to the
presence of an evoked auditory signal associated with noise in the scanner.
Resting state data acquired from the NKI Rockland sample were realigned to
correct for head motion and then each participants’ functional scans were

registered to both their T1‑weighted structural image and then to the MNI152
atlas using boundary based registration (http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/) and
Advanced Normalization Tools software (32). After co‑registration, data were
manually inspected and of the 173 original participants, 11 [6.3%] scans were
discarded due insufficient coverage of orbitofrontal cortex, temporopolar cortex
and/or cerebellum.

Temporal artifacts were identified in each dataset by calculating framewise
displacement (FD) from the derivatives of the six rigid‑body realignment
parameters estimated during standard volume realignment (33), as well as the
root mean square change in BOLD signal from volume to volume (DVARS).
Frames associated with FD > 0.5mm or DVARS > 5% were identified, and
participants with greater than 20% of the resting time points exceeding these
values were excluded from further analysis (HCP group 1: 8/100; HCP group 2:
8/100; NKI group: 10/162). Due to concerns associated with the alteration of the
temporal structure of the images, the data used in the main analysis were not
‘scrubbed’ (33), however we did explicitly compare the results of our experiment
with scrubbed data (missing values were corrected using interpolation) and
found strong correspondence between the outcome measures of the two studies
(see Validation). Following artifact detection, nuisance covariates associated with
the 12 linear head movement parameters (and their temporal derivatives), FD,
DVARS, and anatomical masks from the cerebral spinal fluid and deep cerebral
white matter were regressed from the data using the CompCor strategy (34).
Finally, in keeping with previous time‑resolved connectivity experiments (11), a
temporal band pass filter (0.071 < f < 0.125 Hz) was applied to the data (see
Validation).

Brain parcellation
Following pre‑processing, the mean time series was extracted from 375 pre‑
defined regions‑of‑interest (ROI). To ensure whole‑brain coverage, we extracted:
333 cortical parcels (161 and 162 regions from the left and right hemispheres,
respectively) using the Gordon atlas (35), 14 subcortical regions from Harvard‑
Oxford subcortical atlas (http://fsl.fmrib.ox.ac.uk/), and 28 cerebellar regions
from the SUIT atlas (36) for each participant in the study.

Multiplication of temporal derivatives
To estimate functional connectivity between the 375 ROIs, we used a recently
described statistical technique (Multiplication of Temporal Derivatives; MTD –
http://github.com/macshine/coupling/)

(13)

that

allows

greater

temporal

resolution of time‑resolved connectivity in BOLD time series data when
compared to the conventional sliding‑window Pearson’s correlation coefficient
(13). The MTD is computed by calculating the point‑wise product of temporal
derivative of pairwise time series (Equation 1). In order to reduce the
contamination of high‑frequency noise in the time‑resolved connectivity data, the
MTD is averaged by calculating the mean value over a temporal window, w
(https://github.com/macshine/coupling/).

���!"# =

!
!

!!! !"!" × !"!"
!
!!"! × !!"!

[1]

Equation 1 – Multiplication of Temporal Derivatives, where for each time point,
t, the MTD for the pairwise interaction between region i and j is defined
according to equation 1, where dt is the first temporal derivative of the ith or jth
time series at time t, σ is the standard deviation of the temporal derivative time

series for region i or j and w is the window length of the simple moving average.
This equation can then be calculated over the course of a time series to obtain an
estimate of time‑resolved connectivity between pairs of regions.

Time‑resolved functional connectivity
Time‑resolved functional connectivity was calculated between all 375 brain
regions using the MTD (13) within a sliding temporal window of 14 time points
(10.1 seconds for HCP; 16 time points for NKI data ~ 10.4 seconds). Previous
work has shown that, when using the MTD, a window length of 7 time points
provides optimal sensitivity and specificity for detecting dynamic changes in
functional connectivity structure in simulated time series data (13). To balance
these benefits with the need to track changes in slow cortical fluctuations which
are hypothesized to fluctuate at ~0.1 Hz (37), we used a temporal window of 14
time points to calculate a simple moving average of the MTD, which allowed for
estimates of signals at approximately 0.1 Hz. Individual functional connectivity
matrices were calculated within each temporal window, thus generating an
unthresholded (that is, signed and weighted) 3D adjacency matrix (region ×
region × time) for each particpant (see Figure S1).

Vector autoregressive null model
For each time‑resolved outcome measure derived in the above analyses, results
were directly compared to data simulated using a series of stationary, multi‑
dimensional vector autoregressive (VAR) models, which were used to generate
surrogate regional time series satisfying the null hypothesis of a linearly
correlated, stationary, multivariate stochastic process (see Figure S1). In keeping
with Zalesky et al. (16), VAR model order was set at 11, appropriately mimicking
the expected temporal signature of the BOLD response in 0.72s TR data. The

mean covariance matrix across all 92 subjects from the discovery group was used
to generate 2500 independent null data sets, which allows for the appropriate
estimation of the tails of non‑parametric distributions (38). These time series
were then filtered in a similar fashion to the BOLD data. For each analysis, the
maximum statistic was concatenated for each independent simulation and then
used to populate a null distribution, against which each outcome measure was
compared. Null hypotheses were rejected if the observed test statistic was greater
than or less than 2.5% of the most extreme values generated by the 2500 VAR
trials. Importantly, by comparing each time‑resolved outcome measure with the
results from the VAR simulations, we could effectively determine whether or not
the time‑resolved measures allowed for the rejection of the null hypothesis of
temporal stationary (See Figure S1).

Time‑ resolved community structure
The Louvain modularity algorithm from the Brain Connectivity Toolbox (BCT;
(39) was used in combination with the MTD to estimate both time‑averaged and
time‑resolved

community

structure.

The

Louvain

algorithm

iteratively

maximizes the modularity statistic, Q, for different community assignments until
the maximum possible score of Q has been obtained (see Equation 2). The
modularity estimate for a given network is therefore a quantification of the
extent to which the network may be subdivided into communities with stronger
within‑module than between‑module connections.

�! =

!
�!

!"

�!"! − �!"! �!! !! −

!
� ! !� !

!"

�!"! − �!"! �!! !!

[2]

Equation 2 – Louvain modularity algorithm, where v is the total weight of the
network (sum of all negative and positive connections), wij is the weighted and
signed connection between regions i and j, eij is the strength of a connection

divided by the total weight of the network, and δMiMj is set to 1 when regions are
in the same community and 0 otherwise. ‘+’ and ‘–‘ superscripts denote all
positive and negative connections, respectively.
For each temporal window, the community assignment for each region was
assessed 500 times and a consensus partition was identified using a fine‑tuning
algorithm from the Brain Connectivity Toolbox (BCT, http://www.brain‑
connectivity‑toolbox.net/). This then afforded an estimate of both the time‑
resolved modularity (QT) and cluster assignment (CiT) within each temporal
window for each participant in the study. All graph theoretical measures were
calculated on weighted and signed connectivity matrices, such that no arbitrary
thresholding was required (39).

Based on time‑resolved community assignments, we estimated within‑module
connectivity by calculating the time‑resolved module‑degree Z‑score (WT; within
module strength) for each region in our analysis (Equation 3) (15).

�!" =

!!" !!!
!!!

!"

[3]

!"

Equation 3 – Module degree Z‑score, WiT, where κiT is the strength of the
connections of region i to other regions in its module si at time T, �!!" is the
average of κ over all the regions in si at time T, and �!! is the standard deviation
!"

of κ in si at time T.

Time‑ resolved hub structure
The participation coefficient, BT, quantifies the extent to which a region connects
across all modules (i.e. between‑module strength) and has previously been used

to characterize hubs within brain networks (e.g. see (4, 40)). The BT for each
region was calculated within each temporal window using Equation 4.

�!" = 1 −

!!"# !
!!!

[4]

!!"

Equation 4 ‑ Participation coefficient BiT, where κisT is the strength of the positive
connections of region i to regions in module s at time T, and κiT is the sum of
strengths of all positive connections of region i at time T. The participation
coefficient of a region is therefore close to 1 if its connections are uniformly
distributed among all the modules and 0 if all of its links are within its own
module.

Cartographic Analysis
Regions were classified according to their position in a 2‑dimensional WT – BT
parameter space using the delineations suggested by Guimera and Amaral
(2005). Specifically, we classified regions with WT < 2.5 as non‑hub nodes and
regions with WT ≥ 2.5 as hubs. Within the class of nodes, regions were further
categorized into: ‘ultra‑peripheral’ (BT < 0.05), ‘peripheral’ (0.05 ≤ BT < 0.3),
‘connector’ (0.3 ≤ BT < 0.65) and ‘kinless’ (BT ≥ 0.65) nodes. Similarly, hub nodes
were classified as ‘provincial’ (BT < 0.3), ‘connector’ (0.3 ≤ BT < 0.8) or ‘kinless’ (Pi ≥
0.8) hubs according to their relative participation in communication between
modules (see Figure 1). The proportion of time spent as each of these
cartographic classes was calculated for the resting state and stationary null
datasets

(Figures

2

and

S3;

images

available

at

http://neurovault.org/collections/HAWDIOCD/; code for this experiment is freely
available at https://github.com/macshine/integration/.). To estimate the extent of
each time‑averaged system involvement in the different cartographic classes, we

calculated the percentage of each region type associated with each of 15 putative
networks, based on an a priori classification from a separate study (35).

To determine whether there were distinct patterns of connectivity associated
with each cartographic class, we calculated the frequency with which each of the
375 regions was present in the same temporal module as a region designated as
either a connector or provincial hub. This allowed us to track the regions
integrated by each hub over time (Fig 2).

Dynamic Fluctuations in Cartography
To track changes in brain‑wide cartography over time, we calculated the total
number of regions that were associated with each cartographic class within each
temporal window. We then correlated the total number of regions residing in
each class across all temporal windows using a Spearman’s rho correlation. A
Louvain clustering algorithm was utilized on the resultant correlation matrix and
identified the presence of two main cartographic ‘temporal clusters’. By
calculating the sum of the number of regions associated with the cartographic
classes within each ‘state’, we were able to track fluctuations in the states over
time (Figure 3c). Given the predominance of peripheral nodes in the resting data,
each state time series was standardized, which then allowed for the identification
of temporal windows associated with either a segregated (i.e. greater relative
number of uPN and PH; ZS) or integrated state (greater relative number of PN,
CN and CH; ZI). The original 3D connectivity matrix containing MTD values was
then reorganized into those windows associated with the two states (i.e. either ZS
or ZI ≥ 1.65). The modularity of each window was then calculated using the
Louvain algorithm (Equation 2) and the resultant values were then compared
statistically using an independent samples t‑test (given the higher frequency of

the integrated state, a random sub‑sample of these windows were selected to
match the frequency of the segregated state). A similar technique was used to
estimate the global efficiency of each temporal window. As global efficiency
(Equation 5) cannot be computed from networks with negative weights (39), we
first thresholded the connectivity matrix within each window at 5% density and
then binarized the resultant matrix before calculating global efficiency.

�!"#$ =

!
! !!!

!
!
!!!∈! ! !,!

[5]

Equation 4 – global efficiency of a network, where n denotes the total nodes in
the network and d(i,j) denotes the shortest path between a node i and
neighboring node j.

Cartographic Profiling
To confirm that the discovery of the two temporal clusters was not biased by the
specific choices of boundaries between cartographic classes, we performed
clustering of temporal windows without the use of class labels. To do so, we
classified the joint histogram of each temporal window (which is naïve to
cartographic boundaries) over time using a k‑means clustering analysis (k = 2;
which was explicitly chosen in an attempt to replicate the finding of two states in
the previous analysis; ZI and ZS > 0). As a result of this analysis, each window
was assigned to one of two clusters. The presented results are from k‑means with
500 random restarts (i.e. replicates as implemented in the MATLAB k‑means
function) to mitigate the well known sensitivity of k‑means to initial conditions.
We then compared the consensus partition of the joint histogram time series
between the two methods. Consensus partitioning for joint histograms was
created by calculating the percentage of time that two time points were in the

same module and then clustering the resultant matrix using the Louvain
algorithm (39). The mean Dice’s coefficient across 100 subjects was 0.792 ± 0.04
(Figure 3f). To compare this result to an appropriate null dataset, we created 2500
randomized binary vectors with the same mean as each subjects’ data and then
calculated the Dice’s coefficient between these random vectors and the k‑means
results. The mean Dice’s coefficient for this null dataset was 0.554 ± 0.08, and as
the mean Dice’s coefficient for the clustering comparison was greater than the
95th centile of the null dataset, we were able to reject the null hypothesis that the
observed Dice coefficient between clustering partitions was due to chance alone
(38).

To ensure that the a priori choice of two clusters for the k‑means analysis was
reflective of the broader patterns in the data across multiple values of k, we re‑
ran the clustering analysis in the discovery cohort of 92 subjects across a range of
k (2‑20) and then compared the resultant cluster partitions to the original states
identified using the ZS and ZI scores by calculating the mutual information
between the each pair of partitions. The partition identified at each value of k was
strongly similar to the pattern identified at k = 2 (mean mutual information =
0.400 ± 0.02). In keeping with the fact that we found strongly reproducible results
for k = 2 across replication cohorts, this suggests that our choice of utilizing k = 2
to cluster the joint histograms over time was reflective of a “natural” clustering
pattern in the data.

To estimate the patterns of brain connectivity associated with each state, we
created a binary regressor for each subject that denoted windows associated with
either the segregated (ZS > 1.65) or integrated state (ZI >1.65). We then calculated
a point‑biserial correlation of each region‑by‑region connectivity measure and

the vector representing state identity. Resultant Pearson’s correlation coefficients
were then normalized using a Fisher’s r‑to‑Z transform and compared between
the two states using a paired‑samples t‑test (FDR, p < 0.05). The pairs of regions
that survived correction were then reorganized according to a pre‑defined
network identity vector (35) and projected onto 375 x 375 adjacency matrix (see
Figure S4).

Task‑based Alterations in Cartographic Profile
To assess task‑based functional connectivity, preprocessed data from the original
92 unrelated subjects from the discovery cohort were collected while these
subjects performed two different tasks in the fMRI environment (31): i) a simple
motor task in which the participants were presented with visual cues that
required them to tap their left or right fingers, squeeze their left or right toes, or
move their tongue in 2 x 12 second blocks of movement; and ii) a visually‑based
N‑back task, which consisted of interleaved 10 second blocks of a high (2‑back)
and low (0‑back) load N‑back task, with object stimuli from four classes (places,
faces, body parts and tools) (see (22) for further details of each experimental
paradigm). Preprocessing of time series data involved distortion correction and
linear head movement correction. The mean time series was then extracted from
the same 375 regions as defined in the resting state analysis. To control for
spurious patterns of connectivity associated with task‑evoked activity, we first
regressed the HRF‑convolved task block data from each time series. The MTD
metric was then calculated on the residuals of this regression using a window
length of 14 (~10 seconds at 0.72 second TR). These data were then subjected to a
cartographic profiling analysis in a similar fashion to the resting state data.

To compare the patterns of time‑resolved connectivity across the two tasks to
those observed during rest, the proportion of each task session associated with
each cartographic class was compared to the proportion in both the other task
and during rest using separate 1‑way ANOVAs with post‑hoc paired‑sample t‑
tests (corrected for multiple comparisons using Bonferroni correction: α/5 = 0.01).
State Z‑scores (ZS = standardized sum of uPN + PH; ZI = standardized sum of PN,
CN & CH) were also calculated for each temporal window, and the proportion of
TRs with a ZS or ZI score ≥ 1.65 with both task and rest blocks were calculated for
each task.

We also tested whether any regions within the 2‑dimensional space were
significantly modulated by task by running a mixed‑effects General Linear
Model analysis at the individual level, fitting the group‑averaged joint histogram
to regressors tracking task and rest blocks in both the motor and the N‑back task,
separately. We then compared the two tasks > rest and the resting state data
statistically using a two‑sided one‑sample t‑test across subjects (FDR, p < 0.05).
Finally, we estimated the relationship between task performance and modularity
(Q) and efficiency (E) by calculating each topological measure over time during
the task and then correlating the resultant vectors with convolved regressors that
represented either task or rest blocks.

In order to assess the alteration in the cartographic profile as a function of task
performance, we estimated the affine transformation (using a correlation cost
function with 3 degrees of freedom, including translation and rotation
parameters) between each individual subjects’ resting state cartographic profile
and the profile observed in both the motor and N‑back task, separately. The
transformation matrices were then entered into a random‑effects analysis

comparing the movement of the cartographic profile as a function of task.
Finally, to determine whether the cartographic profile dynamically reorganized
as a function of task demands, we correlated the transformed resting state
histogram (i.e. the resting state histogram ‘shifted’ according to the affine
transform estimated in the previous step) with the histogram for each time point
during each task, and the mean correlation for both the task and rest block
regressors (trimmed of the first 11 time points to remove the effects of the
previous block) for each subject. These values were then averaged (mean) across
the cohort of 92 individuals.

Replication analysis
To quantify how well our results replicated across sessions and datasets, we
calculated group‑level correlations between each of the measures identified in
our analysis. Overall, we observed a strong positive correlation between the
outcome measures identified in the two sessions (for all statistical tests, p <
0.0001): graph measures – r!! = 0.982, r!! = 0.957 (see Figure S5); cartographic
measures – r!"# = 0.973; r!" = 0.974; r!" = 0.853; r!" = 0.903; r!" = 0.730; and
temporal states (upper triangle of the state correlation matrices) – r!"#"$% = 0.982
(see Figure S6). We also confirmed the presence of these results in a unique
cohort of 92 unrelated participants from the HCP: graph measures – r!! = 0.971,
r!! = 0.967 (Figure S5); cartographic measures – r!"# = 0.962; r!" = 0.960; r!" =
0.918; r!" = 0.921; r!" = 0.755; and temporal states – r!"#"$% = 0.973 (Figure S6).

We also observed similarly positive relationships between the group‑level
outcome measures estimated from the HCP and NKI data (for all statistical tests,
p < 0.0001): graph measures – r!! = 0.941, r!! = 0.857 (Figure S5); cartographic

measures – r!"# = 0.923; r!" = 0.830; r!" = 0.771; r!" = 0.767; r!" = 0.564; and
temporal states – r!"

!"#

= 0.927 (Figure S6). In addition, the mean joint histogram

obtained from the NKI data was similar to the result observed in the HCP data
(see Figure S7).

Validation analysis
Based on the novel methodology and short temporal windows utilized in this
analysis, we performed numerous additional analyses to clarify the relationship
between the main temporal outcome measures calculated in this study with
respect to: i) the choice of functional connectivity algorithm; ii) the use of short
windows; iii) the choice of high pass filter threshold; iv) the potential adverse
effects of spurious noise during the resting state scanning session; and v) the
choice of community detection algorithm.

Effect of connectivity algorithm
We have previously shown that the MTD is more sensitive and specific to subtle
shifts in connectivity structure than those estimated using a sliding‑window
Pearson’s correlation in simulated BOLD data (13). To determine whether using
a sliding‑window Pearson’s correlation gave similar results to the MTD in this
study, we re‑analyzed the data in our experiment using a Pearson’s correlation
with a sliding window of w = 14 (the window length used in our experiment) and
w = 83 (which equates to ~60 seconds, a commonly used window length in the
neuroimaging literature) (41). While the estimates of WT and BT were similar
between the two techniques (mean r = 0.734, p < 0.001), the cartographic profiling
results were distinctly different, particularly with respect to the regions
identified as hubs (mean Pearson’s rPH = ‑0.021 ± 0.02; mean rCH = 0.017 ± 0.01),
however the node estimate were similar between the two measures (mean ruPN =

0.498 ± 0.04; mean rPN = 0.402 ± 0.03; mean rCN = 0.521 ± 0.07). Importantly, the
results of the sliding window Pearson’s analyses were less reproducible than the
MTD across datasets at w = 14, with little or no correlation between hub structure
across replication datasets (rPH = 0.034 ± 0.05; rCH = 0.019 ± 0.07).

Effect of window length
To determine the effects of using a short window length in the calculation of the
MTD on the outcome measures in our experiment, we re‑ran the analysis in all 92
subjects from the original group across a range of window lengths (10‑100 in
intervals of 5 TRs). We then compared the main outcomes measures in our study
(parcel‑wise mean WT, mean BT and percentage time as each cartographic class)
across all window lengths in all 92 subjects using a region‑wise Spearman’s rho
correlation (Figures S5 and S6). Although WT, BT and the percentage of time
spent as a uPN, CN or PH were not affected by window length, there were
observable differences in the estimates of the percentage of time spent as either
an PN or CH using the MTD, suggesting that tracking patterns of connectivity at
shorter windows (here, approximately 10 seconds) using the MTD affords a
unique insight into spatiotemporal dynamics in fMRI BOLD data.

Effect of high pass filter threshold
Recent work on simulated time series has suggested that low frequency signals
in fMRI BOLD data can spuriously effect estimates of sliding window covariance
(41), and as such, it has been recommended that the lower bounds of the high
pass filter used on BOLD data be set to the reciprocal of the window length used
in the sliding window analysis (in our study, this would amount to a low pass
filter of

!
!".!"

seconds ~ 0.1 Hz). In contrast, others have shown that using data

with a high signal to noise ratio can effectively mitigate the potential issues with
aliasing (42). In addition, we have previously shown that the MTD is relatively
insensitive to low frequency fluctuations (13), as the temporal differencing used
to create the MTD renders the technique relatively insensitive to signals with a
lower frequency than the upper bounds of the low pass filter. As such, in
keeping with others (11), we chose to use a high pass filter of 0.071 Hz in our
study. However, to explicitly test whether the inclusion of low frequency altered
the outcome measures in our experiment, we re‑ran our analysis over a range of
high pass filters (0.001 to 0.1, in steps of 0.1), with a low pass filter of 0.125.
Across this entire range, we did not observe any group‑level differences in our
outcome measures of interest (minimum r = 0.718, p < 0.001), confirming that the
signals measured by the MTD were not adversely affected by spurious low
frequency signals in the data.

Effect of preprocessing strategies
To determine whether head motion was associated with each measure, we
calculated the first principal component of the 12 head motion parameters over
time and then correlated this new vector with each outcome measure. We also
correlated the framewise displacement as well as the DVARS values with each
outcome measure. None of these correlations was significant at p < 0.05. To test
for the effects of temporal ‘scrubbing’ (33) and global signal regression, we re‑
analyzed data for the original group of 92 subjects separately and then compared
the outcomes measures across analyses. For the scrubbing analysis, time points
associated with framewise displacement > 0.5mm or DVARS > 5% were removed
and missing data points were then imputed using linear interpolation. Using this
technique, we observed strong positive correlations between outcomes measures
across analyses (mean Pearson’s r > 0.700 for all comparisons), suggesting that

neither preprocessing strategy had a major effect on topological or topographic
measures calculated using the MTD. Finally, to determine whether physiological
sources of noise were associated with each measure, we convolved the heart rate
and respiratory signals with a pre‑defined transfer function (Chang and Glover,
2009) and then correlated the resultant vector either each outcome measure for
the 92 subjects from the discovery group. In both instances, we did not observe a
significant correlation between the outcomes of interest in our analysis and
physiological signals (for each comparison, r < |0.050|, p > 0.05).

Effect of community detection algorithm
To ensure that the modularity assignment within each window was robust across
community detection algorithms, we repeated the analysis using the Infomap
algorithm (43) in the discovery cohort and observed broadly consistent results
(mean mutual information between community partitions = 0.342 ± 0.16).
Furthermore, we also used another popular method, multi‑slice community
detection (44), to detect community structure in the time‑resolved brain. The
temporal modules identified by this method (using standard parameters: γ = ω =
1) also gave similar results (mean mutual information between community
partitions = 0.447 ± 0.21). However, due to practical concerns regarding
computational load and the fact that the Infomap algorithm requires the
thresholding of an adjacency matrix (and as such, is insensitive to anti‑
correlations), we did not use either method for the full study.

Supplementary Figure Legends:
Figure S1: Experimental Design: time series data from 375 brain regions were
extracted from 100 unrelated young adults (made available by the Human
Connectome Project) and subjected to time‑resolved connectivity analysis. After
preprocessing, time‑resolved functional connectivity was estimated using the
Multiplication of Temporal Derivatives, which resulted in a weighted adjacency
matrix for each temporal window. Community structure was computed within
each temporal window, enabling the calculation of time‑resolved module‑degree
Z‑score (WT) and participation coefficient (BT). These values were then subjected
to cartographic analysis of time‑resolved functional connectivity. To test our
results against the null model of stationarity, the covariance matrix from the
resting state data was used to create 2500 unique null datasets using a Vector
Autoregressive Model (denoted with subscript, VAR – i.e. WVAR and BVAR). This data
was then subjected to an identical analysis pipeline, with the maximum statistic
from each iteration extracted to populate a null distribution, against which
results from the resting state data were compared for hypothesis testing.

Figure S2: Within‑ and Between‑module connectivity: a) mean within‑module
connectivity calculated using the module‑degree Z‑score, WT, within each
temporal window (Equation 3: Supplementary Materials); b) between‑module
connectivity was computed using the participation coefficient, BT (Equation 4:
Supplementary Materials); c) individual resting state communities, pre‑defined
using the InfoMap community‑detection algorithm (35), were differentially
balanced towards either high time‑resolved intra‑ (blue) or inter‑modular
connectivity (red); d) we observed an inverse correlation between mean WT and

mean BT across all 100 subjects (r = ‑0.354, p < 0.001) that was not present in the
VAR null data (r = 0.898, p < 0.001).
Figure S3: Spatial topography associated with each class of node identified in
the cartographic analysis: a) ultra‑peripheral nodes – BT < 0.05; b) Peripheral
nodes – 0.05 ≤ BT < 0.3; c) Connector nodes – 0.3 ≤ BT < 0.65. Color intensity
reflects the standardized percentage of time each region spent within each
cartographic class. Key: uPN – ultra‑peripheral nodes; PN – peripheral nodes;
CN – connector nodes; PH – peripheral hubs and CH – connector hubs.

Figure S4: Regional connectivity differences between states: a) Significant
differences in the mean connectivity matrix between the two States are plotted in
yellow/red (Integrated State) and blue (Segregated State). Only results that
survived correction after an independent‑samples t‑test with FDR 0.05 correction
for multiple comparisons are shown; b) rows and columns reflect each of the 375
brain regions, organized according to clustering approach outlined in Gordon et
al., 2014.
Figure S5: Replication of Within‑ and Between‑module connectivity scores:
spatial projection of WT and BT scores for the left hemisphere, subcortical and
cerebellar regions for all subjects from each of the four samples used in the study.
Figure S6: Replication of States: correlation matrix for the sum of each class of
cartographic region over time across all four samples used in the study, as well
as the VAR null model, which was qualitatively distinct from the other four
matrices.

Figure S7: Replication of Cartographic Profiles: mean joint histograms for
single subject from each of the four samples using in the study, comparing the
distribution of WT and BT values over each temporal window.
Figure S8: Effect of Window Length on Within‑ and Between‑module
connectivity: correlation matrices displaying the similarity of the average
estimate of within‑ and between‑module connectivity for the discovery cohort (n
= 92) using a range of window lengths (5 – 100, in steps of 5).

Figure S9: Effect of Window Length on Cartographic measures: correlation
matrices displaying the similarity of the percentage of time that each region
spent as a given cartographic class. While the estimates for uPN, CN and PH
were similar across all window lengths > 5, there were marked differences in the
regions identified as PN or CH at low to intermediate window lengths.

Figure S10: Temporal fluctuations in integration and segregation in the resting
state: movie of a cartographic profile of resting state data from a single subject
from the HCP dataset (subject #100307).

Figure S11: Temporal fluctuations in integration and segregation in the resting
state: movie of a cartographic profile of resting state data from a single subject
from the NKI Rockland dataset (subject #0102157).

Figure S12: Temporal fluctuations in integration and segregation during task
performance: movie of a cartographic profile of N‑back data from a single
subject from the HCP dataset (subject #100307). A bar chart detailing the current
block of the experiment is projected next to the cartographic profile.

Analysis

Time series
Data

rsfcMRI data

Covariance

VAR Time series

100 unrelated subjects

Matrix

2500 iterations

Time series

Time series

.

Time‑resolved
Covariance
(MTD; w = 14)
Reject H0 if value
> 2.5% max VARDIST

Time Resolved
Graph Analyses

Figure S1

a)

b)

Mean Module‑degree Z‑score

Mean Participation Coeﬃcient

‑2

0.24

CBM

FTp
2

2

d)

SC

CPar

RSp
0

DMN

SN

WTZ

‑2

FPN

AUD

DAN

CON
VIS

SMH
SMM

VAN

v
BTZ

0.28

Participation Coeﬃcient (BT)

c)

0

0.32

0.32

r = ‑0.354

0.24
‑1
‑0.1

‑0.05

0

0

0.05

Module‑Degree Z‑score (WT)

1
0.1

Figure S2

a)

Ultra‑Peripheral Nodes

b)

% time uPN
4.0

5.0

c)

Peripheral Nodes

Connector Nodes

% time CN

% time PN
6.0

88.0

90.0

92.0

3.0

3.5

4.0

Figure S3

a)
Auditory (24)
Cingulo‑opercular (40)

Integrated
State
0.5

Cingulo‑parietal (5)
Default (41)
Dorsal AWention (32)
Frontoparietal (24)
Frontotemporal (47)
Retrosplenial (8)

0.0

Salience (4)
Somatomotor‑hand (38)
Somatomotor‑mouth (8)
Ventral AWention (23)
Visual (39)
Subcortical (14)
Cerebellar (28)

b)

‑0.5
Segregated
State

Figure S4

Replication Results
Within Module

Between Module

Original

Sessions

Subjects

Studies

Mean Module‑degree Z‑score

Mean Participation Coeﬃcient

‑2

0.24

0

2

0.28

0.32

Figure S5

uPN
uPN PHPH PN
PN CN
CN
uPN
uPN

Across
Sessions

Original Data
uPN

PH

PN

CN

PH
PN

0.49
0.49
‑0.98

‑0.98
‑0.52

‑0.52

‑0.21
‑0.02
0.34

‑0.10

‑0.49

‑0.39

‑0.01

‑0.46

0.19

0.47

0.37

PN
PN

‑0.94

‑0.39

CN ‑0.10
CN

‑0.01

0.19

CH ‑0.49
CH

‑0.46

0.47

0.23
0.23

uPN PHPH PN
PN CN
CN
uPN

‑0.60

uPN
uPN

Across
Subjects

‑0.54
0.61

‑0.94

PH
PH

CH

1
uPN

0.37

0.36

CH

‑0.21
‑0.60

‑0.02
‑0.54

State 1

0.34
0.61

‑0.08

‑0.48

‑0.38

‑0.01

‑0.45

0.24

0.46

PH
PH

0.36

PN
PN

‑0.93

‑0.38

CN
CN ‑0.08

‑0.01

0.24

CH
CH ‑0.48

‑0.45

0.46

0.14
0.14

0
uPN
uPN

0.21
0.21

CH
CH

‑0.93

uPN PHPH PN
PN CN
CN
uPN

CN

CH
CH

‑1

Across
Studies

0.28

‑0.97

‑0.25

‑0.53

‑0.21

0.01

‑0.33

0.11

0.53

PH
PH

0.28

PN
PN

‑0.97

‑0.21

CN
CN ‑0.25

0.01

0.11

CH
CH ‑0.53

‑0.33

0.53

State 2

0.16
0.16

uPN PH
PN CN
uPN PH
PN
CN
uPN
uPN

VAR
null model

0.13

CH
CH

CH
CH

0.03

‑0.03

‑0.02

0.08

‑0.09

‑0.01

‑0.99

0.01

PH
PH

0.13

PN
PN

0.03

0.08

CN ‑0.03
CN
CH ‑0.02
CH

‑0.09

‑0.99

‑0.01

0.01

‑0.02
‑0.02

Figure S6

Discovery Cohort (HCP)

Across Subject (HCP)

6

6

5.0
CH

PH

KH

CH

PH

4

2

1.0

0

2

1.0

0

PN

uPN

CN

KN

0.25

0

0.5

0.75

PN

uPN

0.0

‑2
1

0.25

0

KN

0.0

0.5

0.75

1

BT

Across Session (HCP)

Across Study (NKI)

6

6

5.0
CH

PH

CN

‑2

BT

5.0

KH

CH

PH

4

KH

4

2

1.0

0

WT

WT

KH

4

WT

WT

5.0

2

1.0

0

PN

uPN

CN

KN

0.0

‑2
0

0.25

0.5

BT

0.75

1

PN

uPN

CN

KN

0.0

‑2
0

0.25

0.5

0.75

1

BT
Figure S7

Eﬀect of Window Length
Within‑ and Between‑Module Connectivity

WT

BT
1

10
15
20
25
30
35
40
45
50
55
60
65
70
75
80
85
90
95
100

0

‑1
10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100

Window Length (in TRs)

1

10
15
20
25
30
35
40
45
50
55
60
65
70
75
80
85
90
95
100

0

‑1
10 15 20 25 30 35 40 45 50 55 60 65 70 75 80 85 90 95 100

Window Length (in TRs)

Figure S8

Eﬀect of Window Length
Cartographic Classes
uPN

CN

PN

10

10

10

15

15

15

20

20

20

25

25

25

30

30

30

35

35

35

40

40

40

45

45

45

50

50

50

55

55

55

60

60

60

65

65

65

70

70

70

75

75

75

80

80

80

85

85

85

90

90

90

95

95

95

100

100

100

Window Length (in TRs)

Window Length (in TRs)

Window Length (in TRs)

CH

PH
5
1010
1515

10

2020
2525

20

3030
3535

30

4040

40

4545
5050

45

5555
6060

55

6565

65

7070
7575

70

8080
8585

80

9090

90

9595
100
100

100

1

15
25

50

0

60

75

Pearson’s r

35

85
95

Window Length (in TRs)

‑1
Window Length (in TRs)

Figure S9

