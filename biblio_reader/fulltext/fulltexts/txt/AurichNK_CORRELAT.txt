XXIV Brazilian Congress on Biomedical Engineering – CBEB 2014

CORRELATION BETWEEN NOISE ESTIMATES AND GRAPH
THEORETICAL MEASUREMENTS ON RESTING STATE FMRI DATA
N. K. Aurich1, A. R. Franco1,2,3, J. O. Alves Filho1, A. M. Marques da Silva1,3,4
1

PUCRS, Department of Electrical Engineering, School of Engineering, Porto Alegre, Brazil
PUCRS, Graduate Program in Neuroscience, School of Medicine, Porto Alegre Brazil
3
PUCRS, Brain Institute of Rio Grande do Sul (InsCer-RS), Porto Alegre, Brazil
4
PUCRS, School of Physics, PUCRS, Porto Alegre, Brazil
2

email: nathassia.aurich@acad.pucrs.br
Abstract: Graph theory applied to functional Magnetic
Resonance Imaging (fMRI) analysis allows valuable
and specific information of the functional network
structure within the brain. Due to the sensitivity of
graph theoretical measures, any noise in the data may
alter these measurements, including subject head
motion. However, noise in fMRI can be generated not
only by head motion, but several other undesired
sources, such as physiological noise or equipment
errors. The amount of noise can be estimated though an
outlier measurement of the time series within the
voxels. This article aims to assess the impact of noise in
fMRI data in Graph Theoretical Measurements (GTM),
within a normal population, using two parameters;
patient head motion and number of outliers in the
functional data. With different threshold levels used to
calculate the GTM (Global Efficiency, GE;
Characteristic Path Length, CPL; Average Local
Efficiency, ALE; Average Clustering Coefficient, ACC)
we calculate the correlation with the two noise. We
found high levels of correlation between GTM and
patient motion estimation (ME) and outlier
measurements (OM). However, there is a greater
correlation between OM and GTM than ME and GTM.
Our results demonstrated that GTM are affected by
more than just head motion, but by other noise sources
that can be captured by observing the outliers within the
functional time series.
Keywords: fMRI, resting state, graph theoretical
measures

The application of graph theory in fMRI allows us to
get valuable and distinct information that is not obtained
by typical methods that evaluate brain connectivity [2],
such as seed-based connectivity maps. Furthermore,
through the use of resting state fMRI (rs-fMRI) and
electroencephalography data, it was demonstrated that
the human brain is organized in such a way that it
embraces several small-world properties [3][4][5].
Graph theory is increasingly being applied in
neuroimaging data and novel measurements are being
created and tested for their potential applicability to
study the human brain connectome at a structural and
functional level [1][6].
Neuroimaging studies have shown that the brain
topology can vary according to mental state, including
neuropsychological disorders [7][8][9], age [4][10][11]
and even sex [12]. Henceforward, even between healthy
individuals the architecture of the neural network can be
significantly distinct.
Knowing that head motion alters the fMRI signal
and induces erroneous correlations [13] a study of the
impact of head motion on measurements of graph theory
is required. Yan et a., [15] evaluated different forms of
motion estimation in rs-fMRI and found that graph
theoretical
measurements
(GTM)
vary
quite
substantially depending on level of head motion.
However, noise in fMRI can be generated not only
by head motion [14] but several other undesired
reasons, such as: thermal noise intrinsic to the patient
and electronic equipment’s, noise related to the
imperfections of hardware, noise related to cardiac,
respiratory cycle and other physiological processes.
This article aims to assess the impact of noise in
fMRI data in GTM, in a normal population, using two
parameters: patient head motion and number of outliers
in the functional data. The latter was chosen because
outlier measurements not only address motion, but also
other sources of noise.

Introduction
The analysis of complex networks is an area that is
currently being extensively explored. The neural
topology of the brain is a typical example of a complex
network. The analysis of complex networks allows us
to describe important properties of complex systems,
quantifying their structural organization. The study of
topological properties of the network is called graph
theory. When graph theory is applied to evaluate
functional magnetic resonance images (fMRI) data, the
nodes are defined as the brain regions (i.e. regions of
interest - ROIs) chosen a priori, and the edges are the
connections (i.e. functional correlation) between the
ROIs [1].

1/4

Materials and methods
Data Sample
The sample used in this work consists of a publically
available dataset, the 1000 connectomes Functional
Project which is part of the International Neuroimaging
Data-sharing Initiative (INDI) (http://fcon_1000

504

CBEB 2014

XXIV Brazilian Congress on Biomedical Engineering – CBEB 2014

.projects.nitrc.org/) [15]. A subset of one hundred and
two subjects from the Peking University where used in
this study, including only right handed healthy controls.
Data preprocessing
All functional data was preprocessed using AFNI
[16]. Data was initially despiked, slice-time corrected,
and motion corrected (explained more in depth below).
Then it was spatially normalized to a standard space
(MNI152), and passed through a band-pass filter (0.01 0.1 Hz). Additional, the average signal of white matter
and cerebrospinal fluid as well as the six estimated
motion parameters where used as nuisance variables in a
general linear model analysis with the functional data.
Motion Estimate (ME)
Motion correction in functional data is performed
using a 6-parameter rigid body affine transformation
(AFNI - 3dvolreg). Specifically, using a reference image
(typically the first image in the functional scan) and an
optimization algorithm (linearized weighted least
squares) the six motion parameters (translation: x,y,z;
rotation: roll, pitch, yaw) are estimated in each
functional image and used to align data in the
preprocessing steps. The amount of motion in each
image is calculated by:
/

Results
The average ME across all subjects is 0.0672
(±0.0232) and the average OM is 0.0028 (±0.0069).
With a 0.2 threshold on the connectivity matrix, the
resulting average GTM were: GE= 0.568 (±0.022),
CPL=1.959 (±0.065), ALE=0.659 (±0.055) and
ACC=0.430 (±0.051). Correlation between ME and OM
and GTM (with different thresholds on the connectivity
matrix and corresponding statistical p-score) are
displayed in Table 1 and Erro! Fonte de referência não
encontrada., respectively.
Table 1. Correlation – Graph theoretical Measures and
Motion Estimation
GT
Measures
GE
CPL
ALE
ACC

(1)

Threshold
0.3
0.313
(p<0.001)
-0.240
(p<0.05)
0.290
(p<0.005)
0.286
(p<0.005)

0.5
0.269
(p<0.01)
-0.040
(p>0.05)
0.286
(p<0.005)
0.286
(p<0.005)

GT – Graph Theoretical, GE – Global Efficiency, CPL –
Characteristic Path Length, ALE – Average Local Efficiency and ACC
– Average Clustering Coefficient.

where x, y and z are the translation estimates and r,
p, yaw are the rotation estimates, i is image, and s is the
subject. The amount of motion of each subject within a
functional scan was estimated by calculating the
average of Mot(i)s across time, denoted here as motion
estimate (ME) score. ME scores were correlated with
GTM.
Outlier Measurement (OM)
Outliers’ measurements are calculated by analyzing
time series of all the voxels within the brain. For each
voxel, the median (m(v)) and the median absolute
deviation (MAD(v)) are calculated. Next, an acceptable
intensity range for each voxel is defined by [m(v) a·MAD(v) ; m(v)+ a·MAD(v)], where a=Q-1(0.01/N)
·√(π/2), and Q() is the reversed Gaussian cdf and N is
the length of the time series. If a time point of a
particular voxel is outside this range, it is considered an
outlier. For each time point, the total amount of outliers
within all the voxels is computed. Finally, the average
number of outliers throughout time is defined as the
outlier measurement (OM) and is compared to GTM
[17].
Network Extraction
To define the nodes, a mask that divides the brain
into 200 non-overlapping regions [18] was used. To
define the edges, a connectivity matrix was created by
calculating the pairwise functional correlation between
each node-pair. Using the Brain Connectivity Toolbox
[1], the following GTM were computed: characteristic
path length (CPL), global efficiency (GE), average
clustering coefficient (ACC), and average local
efficiency (ALE).

2/4

0.2
0.293
(p<0.005)
-0.282
(p<0.005)
0.293
(p<0.005)
0.261
(p<0.01)

Table 2. Correlation – Graph theoretical Measures and
Outlier Measurements
GT
GE
CPL
ALE
ACC

0.2
0.476
(p<0.001)
-0.435
(p<0.001)
0.375
(p<0.001)
0.369
(p<0.001)

Threshold
0.3
0.475
(p<0.001)
-0.426
(p<0.001)
0.365
(p<0.001)
0.333
(p<0.001)

0.5
0.511
(p<0.001)
-0.151
(p>0.05)
0.397
(p<0.001)
0.347
(p<0.001)

GT – Graph Theoretical, GE – Global Efficiency, CPL –
Characteristic Path Length, ALE – Average Local Efficiency and ACC
– Average Clustering Coefficient.

A graphical representation of the correlation
between GTM and GE are shown in Erro! Fonte de
referência não encontrada.. Analyzing in more detail
Fig. 1(b), it appears that one subject exhibit an elevated
amount of OM (indicated in a red circle). The
correlation between the noise estimates (ME and OM)
and GTM (threshold = 0.2) were recalculated without
the one subject with elevated OM. Correlation between
ME and GTM are the following: GE=0.219 (p<0.05),
CPL=-0.219 (p<0.05), ALE=0.240 (p<0.05) and
ACC=0.203 (p<0.05). Correlation between OM and
GTM without the outlier subjects are the following:
GE=0.443
(p<0.001),
CPL=-0.441
(p<0.001),

505

CBEB 2014

XXIV Brazilian Congress on Biomedical Engineering – CBEB 2014

ALE=0.377 (p<0.001) and ACC=0.342 (p<0.001).
Finally, Additional analysis showed that there was a
correlation of r=0.453 (p<0.001) between the ME and
OM.

a)

data.
Overall, our results indicate that the GTM are more
highly correlated with OM compared to ME. This was
observed for all the GTM and at different levels of
threshold of the connectivity matrix (see Table 1). The
correlation of GTM with OM is higher at all threshold
values, when compared to the correlation of GTM with
ME.
It can also be observed that there is a general
decrease in correlation between the noise estimates and
GTM as connectivity matrix threshold increases. With
higher thresholds only the stronger connections (higher
r-scores) are kept, precisely those that are not affected
by noise. Also, it was observed that there is still a high
level of correlation between GTM and OM, even when
the one subject with elevated OM level was removed
from the analysis. The removal of subjects with high
level of noise or head motion from a study is usually
done in fMRI studies. However, through the results in
this article, this has been shown to not be sufficient
since there still is a correlation between GTM and OM
or ME.

0.7

GE

0.65

0.6

0.55

0.5
0.02

0.04

0.06

0.08

0.1

0.12

0.14

0.16

ME

b)
0.7

GE

0.65

0.6

Conclusion
0.55

0.5

0

0.02

0.04
OM

0.06

Our results agree with the results obtained by
previous study [19], where GTM are affected by head
motion. However, we have extended the analysis and
shown that GTM are affected by more than just head
motion, by observing the outliers within the functional
time series. This is indicated by the correlation score
between ME and OM (r=0.453, p<0.001), where the
correspondence between them is not perfect.
Measuring outliers in the time series within voxels is
not a faultless measurement of the level of noise in
functional data. However, there is still no complete and
precise way to estimate noise.
Further work still needs to be done to completely
understand the effects of noise in GTM. A limitation of
this study is that only one group of subjects was used.
Future work should be performed on datasets from
several different sources. Additionally and more
importantly, we need to develop techniques that reliably
“clean up” functional data which used in brain topology
measurements. Therefore we can reliably use GTM to
understand different clinical populations or groups.

0.08

Figure 1 – Grafical representating of the correlation between (a)
Global Efficiency (GE) and Motion Estimation (ME) and (b) GE and
Outlier Measurement. In (b), red circles respresnt two subjects that
Discussion
had exessive outliers.

Discussion
The objective of this study was to evaluate the effect
of two different methods to measure noise in fMRI data
on graph theoretical measurements: estimation of head
motion and the measurement of time series outliers.
Specifically, the effect was tested with a homogeneous
group of healthy controls, which underwent an rs-fMRI
scan. It was expected and desired that there would be
little or even no relationship between noise
measurements and GTM. However, it was observed that
there is in fact a high level of correlation between noise
measurements (ME and OM) and GTM.
It has been shown that head motion can affect GTM
[19], however, there are also other sources of noise in
fMRI that are not captured by algorithms that estimate
motion. Within the preprocessing steps of fMRI,
algorithms attempt to remove or minimize the effect of
these imperfections within the data, using motion
estimation and average signals from white matter and
cerebrospinal fluid (where it is expected to have no
BOLD signal) as nuisance variables in a multiple
regression analysis. We have performed these
preprocessing steps in our study. However, it is
supposed that OM is a means of measuring the effect of
the all the different noise sources that may affect fMRI

3/4

Acknowledgements
The authors would like to acknowledge the financial
support of Dr. Buchweitz through CAPES project,
PUCRS for the N. Aurich’s scholarship and 1000 Connectomes Functional Project which is part of the International Neuroimaging Data-sharing Initiative (INDI)
for making this dataset available.
References

506

CBEB 2014

XXIV Brazilian Congress on Biomedical Engineering – CBEB 2014

[1]

[2]

[3]

[4]

[5]

[6]

[7]

[8]

[9]

[10]

[11]

M. Rubinov and O. Sporns, “Complex network
measures of brain connectivity: uses and
interpretations.,” Neuroimage, vol. 52, no. 3, pp.
1059–69, Sep. 2010.
H. Cao, M. M. Plichta, A. Schäfer, L. Haddad,
O. Grimm, M. Schneider, C. Esslinger, P.
Kirsch, A. Meyer-Lindenberg, and H. Tost,
“Test-retest reliability of fMRI-based graph
theoretical properties during working memory,
emotion processing, and resting state.,”
Neuroimage, vol. 84, pp. 888–900, Jan. 2013.
S. Micheloyannis, E. Pachou, C. J. Stam, M.
Vourkas, S. Erimaki, and V. Tsirka, “Using
graph theoretical analysis of multi channel EEG
to evaluate the neural efficiency hypothesis.,”
Neurosci. Lett., vol. 402, no. 3, pp. 273–7, Jul.
2006.
S. Achard and E. Bullmore, “Efficiency and
cost of economical brain functional networks.,”
PLoS Comput. Biol., vol. 3, no. 2, p. e17, Feb.
2007.
M. P. van den Heuvel, C. J. Stam, M. Boersma,
and H. E. Hulshoff Pol, “Small-world and scalefree organization of voxel-based resting-state
functional connectivity in the human brain.,”
Neuroimage, vol. 43, no. 3, pp. 528–39, Nov.
2008.
E. Bullmore and O. Sporns, “Complex brain
networks: graph theoretical analysis of
structural and functional systems.,” Nat. Rev.
Neurosci., vol. 10, no. 3, pp. 186–98, Mar.
2009.
Y. Liu, M. Liang, Yuan Zou, Y. Hao, M. Song,
C. Yu, H. Liu, Z. Liu, and T. Jiang, “Disrupted
small-world networks in schizophrenia.,” Brain,
vol. 131, no. Pt 4, pp. 945–61, Apr. 2008.
D. S. Bassett, E. Bullmore, B. a Verchinski, V.
S. Mattay, D. R. Weinberger, and A. MeyerLindenberg, “Hierarchical organization of
human cortical networks in health and
schizophrenia.,” J. Neurosci., vol. 28, no. 37,
pp. 9239–48, Sep. 2008.
M. Rubinov, S. a Knock, C. J. Stam, S.
Micheloyannis, A. W. F. Harris, L. M.
Williams, and M. Breakspear, “Small-world
properties of nonlinear brain activity in
schizophrenia.,” Hum. Brain Mapp., vol. 30, no.
2, pp. 403–16, Feb. 2009.
S. Micheloyannis, M. Vourkas, V. Tsirka, E.
Karakonstantaki, K. Kanatsouli, and C. J. Stam,
“The influence of ageing on complex brain
networks: a graph theoretical analysis.,” Hum.
Brain Mapp., vol. 30, no. 1, pp. 200–8, Jan.
2009.
L. Wang, Y. Li, P. Metzak, Y. He, and T. S.
Woodward, “Age-related changes in topological
patterns of large-scale brain functional networks
during memory encoding and recognition.,”
Neuroimage, vol. 50, no. 3, pp. 862–72, Apr.
2010.

4/4

[12]

[13]

[14]

[15]

[16]

[17]

[18]

[19]

507

L. Tian, J. Wang, C. Yan, and Y. He,
“Hemisphere- and gender-related differences in
small-world brain networks: a resting-state
functional MRI study.,” Neuroimage, vol. 54,
no. 1, pp. 191–202, Jan. 2011.
J. D. Power, K. a Barnes, A. Z. Snyder, B. L.
Schlaggar, and S. E. Petersen, “Spurious but
systematic
correlations
in
functional
connectivity MRI networks arise from subject
motion.,” Neuroimage, vol. 59, no. 3, pp. 2142–
54, Feb. 2011.
S. A. Huettel, A. W. Song, and G. McCarthy,
Functional Magnetic Resonance Imaging, 2a
Edição. Sunderland, Massachusetts U.S.A.:
Sinauer Associates, Inc, 2009, p. 510 p.
B. B. Biswal, M. et al., “Toward discovery
science of human brain function.,” Proc. Natl.
Acad. Sci. U. S. A., vol. 107, no. 10, pp. 4734–9,
Mar. 2010.
R. W. Cox, “AFNI: software for analysis and
visualization of functional magnetic resonance
neuroimages.,” Computers and biomedical
research, an international journal, vol. 29, no.
3. pp. 1–13, Jun-1996.
R. W. Cox, “Outlier Detection in fMRI Time
Series,” in Procedures International Society for
Magnetic Resonance, 2002, vol. 10, p. 1.
R. C. Craddock, G. A. James, P. E.
Holtzheimer, X. P. Hu, and H. S. Mayberg, “A
Whole Brain fMRI Atlas Generated Via
Spatially Constrained Spectral Clustering.,”
Hum. Brain Mapp., vol. 33, no. 8, pp. 1914–
1928, Aug. 2012.
C.-G. Yan, R. C. Craddock, Y. He, and M. P.
Milham,
“Addressing
head
motion
dependencies for small-world topologies in
functional connectomics.,” Front. Hum.
Neurosci., vol. 7, no. December, p. 910, Jan.
2013.

CBEB 2014

